<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        #chartdiv {
            width: 70%;
            height: 800px;
            max-width: 100%;
        }
    </style>
    <script src="https://cdn.amcharts.com/lib/5/index.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/map.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/geodata/worldLow.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/themes/Animated.js"></script>
    <script>
        am5.ready(function () {

            // Create root element
            var root = am5.Root.new("chartdiv");

            // Set themes
            root.setThemes([
                am5themes_Animated.new(root)
            ]);

            // Create the map chart
            var chart = root.container.children.push(am5map.MapChart.new(root, {
                panX: "rotateX",
                panY: "rotateY",
                projection: am5map.geoOrthographic(),
                paddingBottom: 20,
                paddingTop: 20,
                paddingLeft: 20,
                paddingRight: 20
            }));

            // Create main polygon series for countries
            var polygonSeries = chart.series.push(am5map.MapPolygonSeries.new(root, {
                geoJSON: am5geodata_worldLow
            }));

            polygonSeries.mapPolygons.template.setAll({
                tooltipText: "{name}",
                toggleKey: "active",
                interactive: true
            });

            polygonSeries.mapPolygons.template.states.create("hover", {
                fill: root.interfaceColors.get("primaryButtonHover")
            });

            var selectedColor = am5.color(0x84b761);

            polygonSeries.mapPolygons.template.on("active", function (ev) {
                var polygon = ev.target;
                if (!polygon.isActive) {
                    polygon.setAll({ fill: selectedColor });
                } else {
                    polygon.setAll({ fill: chart.get("colors").getIndex(polygonSeries.dataItems.indexOf(polygon.dataItem)) });
                }
            });

            polygonSeries.mapPolygons.template.states.create("active", {
                fill: root.interfaceColors.get("primaryButtonHover")
            });

            // Create series for background fill
            var backgroundSeries = chart.series.push(am5map.MapPolygonSeries.new(root, {}));
            backgroundSeries.mapPolygons.template.setAll({
                fill: root.interfaceColors.get("alternativeBackground"),
                fillOpacity: 0.1,
                strokeOpacity: 0
            });
            backgroundSeries.data.push({
                geometry: am5map.getGeoRectangle(90, 180, -90, -180)
            });

            var graticuleSeries = chart.series.unshift(
                am5map.GraticuleSeries.new(root, {
                    step: 10
                })
            );

            graticuleSeries.mapLines.template.set("strokeOpacity", 0.1)

            // Set up events
            var previousPolygon;
            var selectedColor = am5.color(0x84b761);

            polygonSeries.mapPolygons.template.on("active", function (active, target) {
                if (previousPolygon && previousPolygon != target) {
                    previousPolygon.set("active", false);
                    previousPolygon.fill = chart.get("colors").getIndex(polygonSeries.dataItems.indexOf(previousPolygon.dataItem));
                }
                if (target.get("active")) {
                    selectCountry(target.dataItem.get("id"));

                    target.fill = selectedColor;
                }
                previousPolygon = target;
            });

            function selectCountry(id) {
                polygonSeries.dataItems.each(function (dataItem) {
                    if (dataItem.get("id") === id) {
                        var polygon = dataItem.get("mapPolygon");
                        if (polygon) {
                            var centroid = polygon.geoCentroid();
                            chart.animate({ key: "rotationX", to: -centroid.longitude, duration: 1500 });
                            chart.animate({ key: "rotationY", to: -centroid.latitude, duration: 1500 });
                        }
                    }
                });
            }

            // Uncomment this to pre-center the globe on a country when it loads
            polygonSeries.events.on("datavalidated", function () {
                selectCountry("KR");
            });

            // Function to select a country by its ID
            function selectCountry(id) {
                var dataItem = polygonSeries.getDataItemById(id);
                var target = dataItem.get("mapPolygon");
                if (target) {
                    var centroid = target.geoCentroid();
                    if (centroid) {
                        chart.animate({ key: "rotationX", to: -centroid.longitude, duration: 1500, easing: am5.ease.inOut(am5.ease.cubic) });
                        chart.animate({ key: "rotationY", to: -centroid.latitude, duration: 1500, easing: am5.ease.inOut(am5.ease.cubic) });
                    }
                }
            }

            function selectCountry(id) {
                var dataItem = polygonSeries.getDataItemById(id);
                var target = dataItem.get("mapPolygon");
                if (target) {
                    var centroid = target.geoCentroid();
                    if (centroid) {
                        chart.animate({ key: "rotationX", to: -centroid.longitude, duration: 1500, easing: am5.ease.inOut(am5.ease.cubic) });
                        chart.animate({ key: "rotationY", to: -centroid.latitude, duration: 1500, easing: am5.ease.inOut(am5.ease.cubic) });
                    }
                }
            }
            // Country list by continent
            var continentCountries = {
                "Asia": ["CN", "KR", "IN", "MY", "JP", "TH", "HK", "SG", "TW", "AE", "IL", "BH", "QA", "VN", "SA", "ID", "PH", "PK", "LK", "UZ"],
                "Europe": ["DE", "GB", "FR", "SE", "AT", "DK", "IT", "BE", "NL", "SI", "HU", "CH", "CZ", "RO", "TR", "RS", "PL", "UA", "SK", "FI", "BG", "EE", "GR", "NO", "PT", "LV", "HR", "GE", "BY", "LT", "MT", "BA", "ES"],
                "NorthAmerica": ["US", "CA", "MX", "GT", "CR", "SV", "JM", "NI", "DO", "VG", "PA"],
                "SouthAmerica": ["BR", "CO", "AR", "CL", "VE", "EC", "TT"],
                "Africa": ["ZA", "NG", "EG", "MA", "KE"],
                "Oceania": ["NZ", "AU"]
            };

            function generateCountryList(continent) {
                var ul = document.createElement('ul');
                continentCountries[continent].forEach(function (country) {
                    var li = document.createElement('li');
                    var a = document.createElement('a');
                    a.href = "#";
                    a.textContent = country;
                    a.addEventListener('click', function (event) {
                        event.preventDefault();
                        selectCountry(country);
                    });
                    li.appendChild(a);
                    ul.appendChild(li);
                });
                return ul;
            }

            // Populate country lists
            document.getElementById('asiaList').appendChild(generateCountryList("Asia"));
            document.getElementById('europeList').appendChild(generateCountryList("Europe"));
            document.getElementById('northAmericaList').appendChild(generateCountryList("NorthAmerica"));
            document.getElementById('southAmericaList').appendChild(generateCountryList("SouthAmerica"));
            document.getElementById('AfricaList').appendChild(generateCountryList("Africa"));
            document.getElementById('OceaniaList').appendChild(generateCountryList("Oceania"));

            // Populate country lists
            var asiaList = generateCountryList("Asia");
            var europeList = generateCountryList("Europe");
            var northAmericaList = generateCountryList("NorthAmerica");
            var southAmericaList = generateCountryList("SouthAmerica");
            var AfricaList = generateCountryList("Africa");
            var OceaniaList = generateCountryList("Oceania");

            // Make stuff animate on load
            chart.appear(1000, 100);

        });
    </script>
</head>

<body>
    <div class="countryList" style="float: right;">
        <div id="asiaList">
            <h3>아시아</h3>
        </div>
        <div id="europeList">
            <h3>유럽</h3>
        </div>
        <div id="northAmericaList">
            <h3>북아메리카</h3>
        </div>
        <div id="southAmericaList">
            <h3>남아메리카</h3>
        </div>
        <div id="AfricaList">
            <h3>아프리카</h3>
        </div>
        <div id="OceaniaList">
            <h3>오세아니아</h3>
        </div>
    </div>
    <!--지구본
        > 드래그를 통한 국가 탐색 기능
        > 국가 클릭 시 해당 국가를 화면 정 중앙에 위치시킴
    -->
    <div id="chartdiv"></div>

    <!--바이어 리스트 
        > 
        > 클릭 시 해당 국가로 이동
        > 
    -->
</body>

</html>

</html>